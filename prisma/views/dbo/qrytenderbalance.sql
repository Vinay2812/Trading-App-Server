SELECT
  dbo.qrytenderheaddetail.Tender_No,
  dbo.qrytenderheaddetail.Company_Code,
  dbo.qrytenderheaddetail.Tender_Date,
  dbo.qrytenderheaddetail.Lifting_Date,
  dbo.qrytenderheaddetail.Mill_Code,
  dbo.qrytenderheaddetail.Grade,
  dbo.qrytenderheaddetail.Quantal,
  dbo.qrytenderheaddetail.Packing,
  dbo.qrytenderheaddetail.Bags,
  dbo.qrytenderheaddetail.Payment_To,
  dbo.qrytenderheaddetail.Tender_From,
  dbo.qrytenderheaddetail.Tender_DO,
  dbo.qrytenderheaddetail.Voucher_By,
  dbo.qrytenderheaddetail.Broker,
  dbo.qrytenderheaddetail.Excise_Rate,
  dbo.qrytenderheaddetail.Narration,
  dbo.qrytenderheaddetail.Mill_Rate,
  dbo.qrytenderheaddetail.Created_By,
  dbo.qrytenderheaddetail.Modified_By,
  dbo.qrytenderheaddetail.Year_Code,
  dbo.qrytenderheaddetail.Purc_Rate,
  dbo.qrytenderheaddetail.type,
  dbo.qrytenderheaddetail.Branch_Id,
  dbo.qrytenderheaddetail.Voucher_No,
  dbo.qrytenderheaddetail.Sell_Note_No,
  dbo.qrytenderheaddetail.Brokrage,
  dbo.qrytenderheaddetail.tenderid,
  dbo.qrytenderheaddetail.mc,
  dbo.qrytenderheaddetail.itemcode,
  dbo.qrytenderheaddetail.season,
  dbo.qrytenderheaddetail.pt,
  dbo.qrytenderheaddetail.tf,
  dbo.qrytenderheaddetail.td,
  dbo.qrytenderheaddetail.vb,
  dbo.qrytenderheaddetail.bk,
  dbo.qrytenderheaddetail.ic,
  dbo.qrytenderheaddetail.itemname,
  dbo.qrytenderheaddetail.brokername,
  dbo.qrytenderheaddetail.voucherbyname,
  dbo.qrytenderheaddetail.tenderdoname,
  dbo.qrytenderheaddetail.tenderfromname,
  dbo.qrytenderheaddetail.paymenttoname,
  dbo.qrytenderheaddetail.millname,
  dbo.qrytenderheaddetail.millgstno,
  dbo.qrytenderheaddetail.millstatecode,
  dbo.qrytenderheaddetail.paymenttogstno,
  dbo.qrytenderheaddetail.paymenttogststatecode,
  dbo.qrytenderheaddetail.paymenttocityname,
  dbo.qrytenderheaddetail.paymenttocitypincode,
  dbo.qrytenderheaddetail.paymenttocitystate,
  dbo.qrytenderheaddetail.paymenttocitygststatecode,
  dbo.qrytenderheaddetail.voucherbycitypincode,
  dbo.qrytenderheaddetail.voucherbycityname,
  dbo.qrytenderheaddetail.voucherbycitystate,
  dbo.qrytenderheaddetail.voucherbycitygststatecode,
  dbo.qrytenderheaddetail.brokercityname,
  dbo.qrytenderheaddetail.brokercitypincode,
  dbo.qrytenderheaddetail.brokercitystate,
  dbo.qrytenderheaddetail.brokercitygststatecode,
  dbo.qrytenderheaddetail.millcodecityname,
  dbo.qrytenderheaddetail.millcodecitypincode,
  dbo.qrytenderheaddetail.millcodecitystate,
  dbo.qrytenderheaddetail.millcodecitygststatecode,
  dbo.qrytenderheaddetail.tendorfromcityname,
  dbo.qrytenderheaddetail.tendorfromcitygststatecode,
  dbo.qrytenderheaddetail.tendorfromcitystate,
  dbo.qrytenderheaddetail.tendorfromcitypincode,
  dbo.qrytenderheaddetail.tendorduocityname,
  dbo.qrytenderheaddetail.tendorduocitystate,
  dbo.qrytenderheaddetail.tendorduocitypincode,
  dbo.qrytenderheaddetail.tendorduocitygststatecode,
  dbo.qrytenderheaddetail.Buyer,
  dbo.qrytenderheaddetail.Buyer_Quantal,
  dbo.qrytenderheaddetail.Sale_Rate,
  dbo.qrytenderheaddetail.Commission_Rate,
  dbo.qrytenderheaddetail.Sauda_Date,
  dbo.qrytenderheaddetail.detail_narration,
  dbo.qrytenderheaddetail.ID,
  dbo.qrytenderheaddetail.Buyer_Party,
  dbo.qrytenderheaddetail.IsActive,
  dbo.qrytenderheaddetail.AutoID,
  dbo.qrytenderheaddetail.Delivery_Type,
  dbo.qrytenderheaddetail.tenderdetailid,
  dbo.qrytenderheaddetail.buyerid,
  dbo.qrytenderheaddetail.buyerpartyid,
  dbo.qrytenderheaddetail.buyername,
  dbo.qrytenderheaddetail.buyergstno,
  dbo.qrytenderheaddetail.buyergststatecode,
  dbo.qrytenderheaddetail.buyerpartyname,
  dbo.qrytenderheaddetail.buyerpartygstno,
  dbo.qrytenderheaddetail.buyerpartygststatecode,
  dbo.qrytenderheaddetail.buyeridcityname,
  dbo.qrytenderheaddetail.buyeridcitypincode,
  dbo.qrytenderheaddetail.buyeridcitystate,
  dbo.qrytenderheaddetail.buyerpartycityname,
  dbo.qrytenderheaddetail.buyeridcitygststatecode,
  dbo.qrytenderheaddetail.buyerpartycitypincode,
  dbo.qrytenderheaddetail.buyerpartycitystate,
  dbo.qrytenderheaddetail.buyerpartycitygststatecode,
  dbo.qrytenderheaddetail.millshortname,
  dbo.qrytenderheaddetail.gstratecode,
  dbo.qrytenderheaddetail.gstratename,
  dbo.qrytenderheaddetail.gstrate,
  dbo.qrytenderheaddetail.igstrate,
  dbo.qrytenderheaddetail.sgstrate,
  dbo.qrytenderheaddetail.cgstrate,
  dbo.qrytenderheaddetail.Tender_DateConverted,
  dbo.qrytenderheaddetail.Lifting_DateConverted,
  dbo.qrytenderheaddetail.Sauda_DateConverted,
  dbo.qrytenderheaddetail.payment_date,
  dbo.qrytenderheaddetail.payment_dateConverted,
  dbo.qrytenderheaddetail.sub_broker,
  dbo.qrytenderheaddetail.sbr,
  dbo.qrytenderheaddetail.subbrokername,
  dbo.qrytenderheaddetail.subbrokercityname,
  dbo.qrytenderheaddetail.CashDiff,
  dbo.qrytenderheaddetail.tcs_rate,
  dbo.qrytenderheaddetail.gst_rate,
  dbo.qrytenderheaddetail.tcs_amt,
  dbo.qrytenderheaddetail.gst_amt,
  dbo.qrytenderheaddetail.ShipTo,
  dbo.qrytenderheaddetail.CashDifference,
  dbo.qrytenderheaddetail.shiptoid,
  dbo.qrytenderheaddetail.ShipToname,
  dbo.qrytenderheaddetail.buyershortname,
  dbo.qrytenderheaddetail.Party_Bill_Rate,
  dbo.qrytenderheaddetail.Buyer_Quantal - SUM(ISNULL(dbo.nt_1_deliveryorder.quantal, 0)) AS BALANCE
FROM
  dbo.qrytenderheaddetail
  LEFT JOIN dbo.nt_1_deliveryorder ON dbo.qrytenderheaddetail.tenderdetailid = dbo.nt_1_deliveryorder.tenderdetailid
GROUP BY
  dbo.qrytenderheaddetail.Tender_No,
  dbo.qrytenderheaddetail.Company_Code,
  dbo.qrytenderheaddetail.Tender_Date,
  dbo.qrytenderheaddetail.Lifting_Date,
  dbo.qrytenderheaddetail.Mill_Code,
  dbo.qrytenderheaddetail.Grade,
  dbo.qrytenderheaddetail.Quantal,
  dbo.qrytenderheaddetail.Packing,
  dbo.qrytenderheaddetail.Bags,
  dbo.qrytenderheaddetail.Payment_To,
  dbo.qrytenderheaddetail.Tender_From,
  dbo.qrytenderheaddetail.Tender_DO,
  dbo.qrytenderheaddetail.Voucher_By,
  dbo.qrytenderheaddetail.Broker,
  dbo.qrytenderheaddetail.Excise_Rate,
  dbo.qrytenderheaddetail.Narration,
  dbo.qrytenderheaddetail.Mill_Rate,
  dbo.qrytenderheaddetail.Created_By,
  dbo.qrytenderheaddetail.Modified_By,
  dbo.qrytenderheaddetail.Year_Code,
  dbo.qrytenderheaddetail.Purc_Rate,
  dbo.qrytenderheaddetail.type,
  dbo.qrytenderheaddetail.Branch_Id,
  dbo.qrytenderheaddetail.Voucher_No,
  dbo.qrytenderheaddetail.Sell_Note_No,
  dbo.qrytenderheaddetail.Brokrage,
  dbo.qrytenderheaddetail.tenderid,
  dbo.qrytenderheaddetail.mc,
  dbo.qrytenderheaddetail.itemcode,
  dbo.qrytenderheaddetail.season,
  dbo.qrytenderheaddetail.pt,
  dbo.qrytenderheaddetail.tf,
  dbo.qrytenderheaddetail.td,
  dbo.qrytenderheaddetail.vb,
  dbo.qrytenderheaddetail.bk,
  dbo.qrytenderheaddetail.ic,
  dbo.qrytenderheaddetail.itemname,
  dbo.qrytenderheaddetail.brokername,
  dbo.qrytenderheaddetail.voucherbyname,
  dbo.qrytenderheaddetail.tenderdoname,
  dbo.qrytenderheaddetail.tenderfromname,
  dbo.qrytenderheaddetail.paymenttoname,
  dbo.qrytenderheaddetail.millname,
  dbo.qrytenderheaddetail.millgstno,
  dbo.qrytenderheaddetail.millstatecode,
  dbo.qrytenderheaddetail.paymenttogstno,
  dbo.qrytenderheaddetail.paymenttogststatecode,
  dbo.qrytenderheaddetail.paymenttocityname,
  dbo.qrytenderheaddetail.paymenttocitypincode,
  dbo.qrytenderheaddetail.paymenttocitystate,
  dbo.qrytenderheaddetail.paymenttocitygststatecode,
  dbo.qrytenderheaddetail.voucherbycitypincode,
  dbo.qrytenderheaddetail.voucherbycityname,
  dbo.qrytenderheaddetail.voucherbycitystate,
  dbo.qrytenderheaddetail.voucherbycitygststatecode,
  dbo.qrytenderheaddetail.brokercityname,
  dbo.qrytenderheaddetail.brokercitypincode,
  dbo.qrytenderheaddetail.brokercitystate,
  dbo.qrytenderheaddetail.brokercitygststatecode,
  dbo.qrytenderheaddetail.millcodecityname,
  dbo.qrytenderheaddetail.millcodecitypincode,
  dbo.qrytenderheaddetail.millcodecitystate,
  dbo.qrytenderheaddetail.millcodecitygststatecode,
  dbo.qrytenderheaddetail.tendorfromcityname,
  dbo.qrytenderheaddetail.tendorfromcitygststatecode,
  dbo.qrytenderheaddetail.tendorfromcitystate,
  dbo.qrytenderheaddetail.tendorfromcitypincode,
  dbo.qrytenderheaddetail.tendorduocityname,
  dbo.qrytenderheaddetail.tendorduocitystate,
  dbo.qrytenderheaddetail.tendorduocitypincode,
  dbo.qrytenderheaddetail.tendorduocitygststatecode,
  dbo.qrytenderheaddetail.Buyer,
  dbo.qrytenderheaddetail.Buyer_Quantal,
  dbo.qrytenderheaddetail.Sale_Rate,
  dbo.qrytenderheaddetail.Commission_Rate,
  dbo.qrytenderheaddetail.Sauda_Date,
  dbo.qrytenderheaddetail.detail_narration,
  dbo.qrytenderheaddetail.ID,
  dbo.qrytenderheaddetail.Buyer_Party,
  dbo.qrytenderheaddetail.IsActive,
  dbo.qrytenderheaddetail.AutoID,
  dbo.qrytenderheaddetail.Delivery_Type,
  dbo.qrytenderheaddetail.tenderdetailid,
  dbo.qrytenderheaddetail.buyerid,
  dbo.qrytenderheaddetail.buyerpartyid,
  dbo.qrytenderheaddetail.buyername,
  dbo.qrytenderheaddetail.buyergstno,
  dbo.qrytenderheaddetail.buyergststatecode,
  dbo.qrytenderheaddetail.buyerpartyname,
  dbo.qrytenderheaddetail.buyerpartygstno,
  dbo.qrytenderheaddetail.buyerpartygststatecode,
  dbo.qrytenderheaddetail.buyeridcityname,
  dbo.qrytenderheaddetail.buyeridcitypincode,
  dbo.qrytenderheaddetail.buyeridcitystate,
  dbo.qrytenderheaddetail.buyerpartycityname,
  dbo.qrytenderheaddetail.buyeridcitygststatecode,
  dbo.qrytenderheaddetail.buyerpartycitypincode,
  dbo.qrytenderheaddetail.buyerpartycitystate,
  dbo.qrytenderheaddetail.buyerpartycitygststatecode,
  dbo.qrytenderheaddetail.millshortname,
  dbo.qrytenderheaddetail.gstratecode,
  dbo.qrytenderheaddetail.gstratename,
  dbo.qrytenderheaddetail.gstrate,
  dbo.qrytenderheaddetail.igstrate,
  dbo.qrytenderheaddetail.sgstrate,
  dbo.qrytenderheaddetail.cgstrate,
  dbo.qrytenderheaddetail.Tender_DateConverted,
  dbo.qrytenderheaddetail.Lifting_DateConverted,
  dbo.qrytenderheaddetail.Sauda_DateConverted,
  dbo.qrytenderheaddetail.payment_date,
  dbo.qrytenderheaddetail.payment_dateConverted,
  dbo.qrytenderheaddetail.sub_broker,
  dbo.qrytenderheaddetail.sbr,
  dbo.qrytenderheaddetail.subbrokername,
  dbo.qrytenderheaddetail.subbrokercityname,
  dbo.qrytenderheaddetail.CashDiff,
  dbo.qrytenderheaddetail.tcs_rate,
  dbo.qrytenderheaddetail.gst_rate,
  dbo.qrytenderheaddetail.tcs_amt,
  dbo.qrytenderheaddetail.gst_amt,
  dbo.qrytenderheaddetail.ShipTo,
  dbo.qrytenderheaddetail.CashDifference,
  dbo.qrytenderheaddetail.shiptoid,
  dbo.qrytenderheaddetail.ShipToname,
  dbo.qrytenderheaddetail.buyershortname,
  dbo.qrytenderheaddetail.Party_Bill_Rate;