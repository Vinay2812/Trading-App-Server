SELECT
  doc_no,
  doc_date,
  doc_dateConverted,
  ac_code,
  unit_code,
  broker,
  pono,
  quantal,
  sell_rate,
  remark,
  company_code,
  carpid,
  ac,
  uc,
  br,
  carporatepartyaccountname,
  carporatepartyunitname,
  carporatepartybrokername,
  SUM(ISNULL(doqntl, 0)) AS dispatched,
  quantal - SUM(ISNULL(doqntl, 0)) AS balance,
  selling_type,
  bill_to,
  carporatebilltoname,
  bt,
  DeliveryType,
  CommissionRate
FROM
  dbo.qrycarporatedodetail
GROUP BY
  doc_no,
  doc_date,
  doc_dateConverted,
  ac_code,
  unit_code,
  broker,
  pono,
  quantal,
  sell_rate,
  remark,
  company_code,
  carpid,
  ac,
  uc,
  br,
  carporatepartyaccountname,
  carporatepartyunitname,
  carporatepartybrokername,
  selling_type,
  bill_to,
  carporatebilltoname,
  bt,
  DeliveryType,
  CommissionRate;